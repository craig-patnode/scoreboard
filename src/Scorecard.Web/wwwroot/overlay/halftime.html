<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Half Time Overlay</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/8.0.0/signalr.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: transparent; font-family: 'Assistant', 'Segoe UI', 'Arial', sans-serif; overflow: hidden; }

        .halftime-container {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            filter: drop-shadow(0 8px 30px rgba(0, 0, 0, 0.6));
            animation: fadeSlideIn 1s ease-out forwards; opacity: 0;
        }
        @keyframes fadeSlideIn { to { opacity: 1; transform: translate(-50%, -50%) scale(1); } }

        .halftime-card {
            background: linear-gradient(180deg, #1a1a1a 0%, #2a2a2a 50%, #1a1a1a 100%);
            border: 2px solid #FFD700; border-radius: 12px;
            padding: 35px 50px; text-align: center; min-width: 450px;
        }

        .halftime-label {
            font-size: 16px; color: #FFD700; text-transform: uppercase;
            letter-spacing: 6px; margin-bottom: 25px; font-weight: 900;
        }

        .score-row { display: flex; align-items: center; justify-content: center; gap: 20px; margin-bottom: 15px; }
        .ht-team { text-align: center; min-width: 130px; }
        .ht-team-name {
            font-size: 18px; font-weight: 900; color: #ffffff; text-transform: uppercase;
            font-family: 'Arial Black', 'Impact', sans-serif; margin-bottom: 5px;
        }
        .ht-score {
            font-size: 48px; font-weight: 900; color: #ffffff;
            font-family: 'Arial Black', sans-serif;
        }
        .ht-separator { font-size: 48px; color: #FFD700; font-weight: 900; }

        .cards-row { display: flex; justify-content: center; gap: 40px; margin-top: 10px; }
        .ht-cards { display: flex; gap: 8px; align-items: center; }
        .ht-card-icon { width: 14px; height: 18px; border-radius: 1px; display: inline-block; }
        .ht-yellow { background: #FFD700; }
        .ht-red { background: #DC143C; }
        .ht-card-count { font-size: 16px; color: #ccc; font-weight: 600; }
    </style>
</head>
<body>
    <div class="halftime-container">
        <div class="halftime-card">
            <div class="halftime-label">âš½ Half Time</div>
            <div class="score-row">
                <div class="ht-team">
                    <div class="ht-team-name" id="homeTeamName">HOME</div>
                    <div class="ht-cards">
                        <span class="ht-card-icon ht-yellow"></span><span class="ht-card-count" id="homeYellow">0</span>
                        <span class="ht-card-icon ht-red"></span><span class="ht-card-count" id="homeRed">0</span>
                    </div>
                </div>
                <div>
                    <div class="ht-score" id="homeScore">0</div>
                </div>
                <div class="ht-separator">-</div>
                <div>
                    <div class="ht-score" id="awayScore">0</div>
                </div>
                <div class="ht-team">
                    <div class="ht-team-name" id="awayTeamName">OPPONENT</div>
                    <div class="ht-cards">
                        <span class="ht-card-icon ht-yellow"></span><span class="ht-card-count" id="awayYellow">0</span>
                        <span class="ht-card-icon ht-red"></span><span class="ht-card-count" id="awayRed">0</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const pathParts = window.location.pathname.split('/');
        const streamKey = pathParts[pathParts.length - 1] || new URLSearchParams(window.location.search).get('key');

        function updateHalfTime(state) {
            document.getElementById('homeTeamName').textContent = state.homeTeamName || 'HOME';
            document.getElementById('awayTeamName').textContent = state.awayTeamName || 'OPPONENT';
            document.getElementById('homeScore').textContent = state.homeScore || 0;
            document.getElementById('awayScore').textContent = state.awayScore || 0;
            document.getElementById('homeYellow').textContent = state.homeYellowCards || 0;
            document.getElementById('homeRed').textContent = state.homeRedCards || 0;
            document.getElementById('awayYellow').textContent = state.awayYellowCards || 0;
            document.getElementById('awayRed').textContent = state.awayRedCards || 0;
        }

        const connection = new signalR.HubConnectionBuilder()
            .withUrl(`${window.location.origin}/hubs/game`)
            .withAutomaticReconnect()
            .build();

        connection.on("GameStateUpdated", updateHalfTime);
        connection.onreconnected(() => { if (streamKey) connection.invoke("JoinStream", streamKey); });
        connection.start().then(() => { if (streamKey) connection.invoke("JoinStream", streamKey); })
            .catch(() => setTimeout(() => location.reload(), 5000));
    </script>
</body>
</html>
